<h1>OASIS Brain MRI Stable Diffusion</h1>

<p> Jonathan Allen (s4640736) </p>
<h2> Model Description </h2>
Stable Diffusion is a deep learning image generation model. Unlike other diffusion models that denoise in pixel space, Stable Diffusion uses a Latent Diffusion Model (LDM) to add and remove noise in the latent space, making it more time and space efficient. An Encoder is used to transform images into the latent space, while a Decoder is used to transform the latent space back into pixel space. In the model, each denoising step is performed by a modified U-Net architecture consisting of cross attention and positional embedding. The cross attention increases the segmentation accuracy by enhancing prominent regions of the image and suppressing irrelevant regions. The positional embedding allows the model to know what noising or denoising step it is on, vital to add and remove the correct amount of noise to an image, as the basic U-Net architecture does not allow for this. For more information on the model used and for the mathematics behind it please read this [paper](https://arxiv.org/pdf/2112.10752.pdf).

![image](https://miro.medium.com/max/1400/0*rW_y1kjruoT9BSO0.png)Source: https://arxiv.org/pdf/2112.10752.pdf

For the model implemented here, the conditioning part of the stable diffusion model was intentionally dismissed as unnecessary since the task is to only recreate one specific type of data set. The conditioning would be needed if we were trying to recreate many types of data from a given input. For example, creating an image from text, in this case, text is the conditioning element.

<h2> How Stable Diffusion Works </h2>
At a high level, diffusion models work by progressively altering the training data by adding noise, and then "learn" to recover the data by reversing this noising process. After training, this reversing of the noising process can be applied to random noise, hence generating new data. In other words, a complete diffusion model can produce coherent images from initial random noise. 

In this case specifically, the model is trained on OASIS brain MRI data, it adds a specific amount of noise to the image, and then iteratively learns how to remove the added noise in hopes to recover the altered training image. Once trained, it can be given a similar photo containing nothing but random noise, and then using the learned denoising process, generate a photo-realistic image resembling the training data.

This image shows a visual representation of the model noising an image and then learning to denoise it by reversing the process. Noising of the image going left to right on the first row and denoising of the image going right to left on the second row.
![Example Noising Process](https://lh3.googleusercontent.com/432gw-wUaTSikRtRp2IjoIRxM_xLYhy06LXcUYfHmVZoGJfWGl88HX5DO4jUxxhaZdPY_yDsKymTyHqO3oNz5vVv71poNJAwkbaYXtStpA5XyjPTqjvA3NNJK5rJndkgru4f9DPfqdqwKQuazuND-yWpn0uplZ-6mUfboiLh1BNEu1a92Pxm83gDtYfhr7chxzZW1ibgPp6dJ8G75yWy26SxjA6n9hgSDpqQgQj-QmRZURf7zcXnGbPMvk_1Je-uB2nzxIfswWVyb7isxdBKU75NzyV-a6zNLdZY9CDEgU50jzrCYeAA8_mjWNFDHsG_kyQgsCbAcdt4Logvk-d-ipqi12LRE83XsfOWopI9-Bs9FDN0eDBndNTPWh_PsGzaw1ZyAn-tJSzmtRjz3DQnnQ3J34BvFiYkZyPSBErDLvAYemeIphUZ-u7qxlbgi9HmkOU_g4AtMEc637LuMhD8bQN8u9y2cA74giWEce_Xw8E62oR4oowKkKCWWLw6HFs_JoLAAb4NJ6eJs_2JDOvDcKVVyNt07_mWZdNx2xvB2bjEoKIf-s4iBMT0q0RcxqUfhZk8ItM9nRuEkrx1DuGc1BuDWLjsfSUIZ5UHRgRlO11G6-zHhmvPUyAYnguS3k6bs8rTrMmGf6Fu6zWIydvxEUtsfJ97ZsRbmDCe1pbq4dVF-PMLoeTAKQagh0iTd6gvlsHijNsq2erqU0tSiMyVlGOk8tsZs5hVlFDJXCxaMXQpi6Mbpb_ErI-azmB0-CUi8mAdOphz2AKSp_0dMTgyIn25Gc3JI8BFerIVYSee2zjMYPb9NxNskS77yNRyPNCMWKAu4Ogv4zQihrPltHwo0kvz82Fcz6_XjRBy3NOh6NvyRBNujKz24_90iKvrg8wxNo6l4v5Z93MXhv70ctW3d8QPR1zL_I145aBp1A=w642-h319-no?authuser=0)
